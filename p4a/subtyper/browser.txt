Subtyping From a Browser
========================

Subtypes of content should be available from the browser.

Set Up
------

Setup our Manager user.

    >>> uf = app.acl_users
    >>> uf._doAddUser('admin', 'admin', ['Manager'], [])

Now we need to setup some new content type descriptors.

    >>> from p4a.subtyper import interfaces
    >>> import zope.interface
    >>> import zope.component
    >>> import zope.app.content.interfaces

    >>> class IFoo(zope.interface.Interface): pass
    >>> zope.interface.alsoProvides(IFoo,
    ...                             zope.app.content.interfaces.IContentType)

    >>> class Foo1Descriptor(object):
    ...     zope.interface.implements(interfaces.IPortalTypedDescriptor)
    ...     title = u'Foo1'
    ...     description = u'Random Description'
    ...     type_interface = IFoo
    ...     for_portal_type = 'Document'

    >>> zope.component.provideUtility(Foo1Descriptor(), name=u'foo1')

And of course we get the test browser.

    >>> import Products.Five.testbrowser
    >>> browser = Products.Five.testbrowser.Browser()
    >>> browser.addHeader('Authorization', 'Basic admin:admin')

Accessing Menu's
----------------

We should be able to simply go to the root of the plone site and see the
newly registered content menu's.

    >>> portal = app.plone
    >>> browser.open(portal.absolute_url())

Make sure the actual subtypes menu dropdown is displayed.

    >>> browser.getLink('Sub-types')
    <Link text='Sub-types' url=...>

And now we make sure the menu item's are there.

    >>> browser.getLink('Foo1')
    <Link text='Foo1' url='.../@@subtyper/change_type?descriptor=...Foo1Descriptor'>
